

/* --- Contenedor del contenido del modal Thickbox --- */
#TB_ajaxContent {
    overflow-y: auto !important; /* Scroll vertical si es necesario */
    padding: 25px 30px !important; /* Espaciado interno */
    box-sizing: border-box;
}



/* ==========================================================================
   ESTILOS para ionstancias
   ========================================================================== */
/* --- Formulario específico --- */
#add-instance-form {
    display: block; /* Asegura que sea un bloque */
    width: 100%;
    box-sizing: border-box;
}

/* --- Contenedores de campos (párrafos) --- */
#add-instance-form p {
    display: block; /* Cada 'p' es una fila */
    margin: 0 0 15px 0; /* Espacio debajo de cada campo/grupo */
    padding: 0;
}

/* --- Etiquetas --- */
#add-instance-form label {
    display: block; /* Ocupa su propia línea */
    margin-bottom: 5px; /* Espacio entre etiqueta y campo */
    font-weight: 600; /* Estilo WP */
    color: #2c3338; /* Color WP */
}

/* --- Campos de Texto y URL --- */
#add-instance-form input[type="text"],
#add-instance-form input[type="url"] {
    display: block; /* Ocupa su propia línea */
    width: 100%; /* Ancho completo */
    padding: 6px 8px; /* Padding WP */
    border: 1px solid #8c8f94; /* Borde WP */
    box-shadow: inset 0 1px 2px rgba(0,0,0,.07); /* Sombra WP */
    box-sizing: border-box; /* Padding/border dentro del ancho */
}

/* --- Descripciones --- */
#add-instance-form .description {
    display: block; /* Ocupa su propia línea */
    margin-top: 4px; /* Espacio sobre la descripción */
    margin-left: 0; /* Sin indentación */
    font-size: 0.85em; /* Tamaño WP */
    color: #646970; /* Color ayuda WP */
    font-style: italic;
}

/* --- Estilo para campo Readonly --- */
#add-instance-form input[readonly] {
    background-color: #f0f0f1; /* Fondo gris WP */
    cursor: not-allowed; /* Cursor */
    border-color: #dcdcde; /* Borde más claro */
}

/* --- Grupo de Checkboxes (Fieldset) --- */
#add-instance-form fieldset {
    display: block; /* Ocupa su propia línea */
    border: 1px solid #ddd; /* Borde suave */
    padding: 15px;
    margin: 0 0 20px 0; /* Margen inferior */
    width: 100%;
    box-sizing: border-box;
}

#add-instance-form fieldset legend {
    font-weight: 600; /* Estilo WP */
    padding: 0 5px;
    color: #2c3338;
}

/* --- Cada fila de Checkbox dentro del Fieldset --- */
#add-instance-form fieldset p {
    display: block; /* Cada grupo (checkbox+label+desc) en su línea */
    margin-bottom: 10px; /* Espacio entre checkboxes */
}
#add-instance-form fieldset p:last-child {
    margin-bottom: 0; /* Sin espacio extra al final */
}

/* --- Checkbox --- */
#add-instance-form fieldset input[type="checkbox"] {
    margin-right: 6px; /* Espacio a la derecha */
    vertical-align: middle; /* Alinear con texto */
}

/* --- Etiqueta del Checkbox --- */
#add-instance-form fieldset input[type="checkbox"] + label {
    display: inline-block; /* Al lado del checkbox */
    font-weight: normal; /* No negrita */
    margin: 0;
    vertical-align: middle;
}

/* --- Descripción del Checkbox --- */
#add-instance-form fieldset .description {
    display: inline; /* Al lado de la etiqueta */
    margin-left: 5px; /* Espacio a la izquierda */
    font-style: normal; /* Sin cursiva */
    font-size: 0.8em; /* Más pequeño */
    color: #646970;
    vertical-align: middle;
}

/* --- Botón de Envío --- */
#add-instance-form .submit {
    display: block; /* Ocupa su propia línea */
    margin-top: 20px; /* Espacio arriba */
    padding: 0;
    text-align: left; /* Alinear a la izquierda */
}

#add-instance-form #submit-add-instance {
    /* Hereda los estilos de .button .button-primary */
}

/* --- FIN ESTILOS DESDE CERO Modal Añadir Instancia --- */
/* ==========================================================================
   ESTILOS para Historial de Chats
   ========================================================================== */

.crm-chat-history-page .crm-chat-container {
    display: flex; /* Activa Flexbox */
    border: 1px solid #ccd0d4;
    height: calc(100vh - 100px); /* Altura ajustable (resta altura del header/footer de WP y margen superior) - Ajusta el 100px según sea necesario */
    background-color: #f6f7f7; /* Fondo claro */
    margin-top: 20px;
    /* overflow: hidden; */ /* <-- Prueba quitando esto del contenedor principal */
}

.crm-chat-history-page .chat-list-column {
    flex: 0 0 30%; /* No crece, no encoge, base del 30% */
    max-width: 350px; /* Ancho máximo opcional */
    border-right: 1px solid #ccd0d4; /* Separador */
    display: flex;
    flex-direction: column; /* Apila header y lista */
    background-color: #fff; /* Fondo blanco para la lista */
}

.crm-chat-history-page .chat-list-header {
    padding: 10px 15px;
    border-bottom: 1px solid #ccd0d4;
    background-color: #f0f0f1; /* Fondo ligeramente gris */
}

.crm-chat-history-page .chat-list-header h2 {
    margin: 0;
    font-size: 1.1em;
}

/* --- Estilos Buscador de Chats --- */
.crm-chat-history-page .chat-search-container {
    padding: 10px 0; /* Espacio arriba/abajo del buscador */
}

.crm-chat-history-page #chat-search-input {
    width: 100%;
    padding: 8px 10px;
    border: 1px solid #ddd;
    border-radius: 20px; /* Bordes redondeados */
    box-sizing: border-box;
    font-size: 0.9em;
}

.crm-chat-history-page .chat-list-items {
    flex-grow: 1; /* Ocupa el espacio restante */
    overflow-y: auto; /* Scroll si la lista es larga */
    padding: 10px 0; /* Espacio arriba/abajo */
}

/* --- Estilos Lista de Chats --- */

.crm-chat-history-page .chat-list-item {
    display: flex;
    align-items: center;
    padding: 10px 15px;
    border-bottom: 1px solid #f0f0f1; /* Separador más suave */
    cursor: pointer;
    transition: background-color 0.15s ease;
}

.crm-chat-history-page .chat-list-item:last-child {
    border-bottom: none;
}
.crm-chat-history-page .chat-list-item:hover {
    background-color: #f5f5f5; /* Fondo al pasar el mouse */
}

.crm-chat-history-page .chat-list-item.active { /* Estilo para el chat seleccionado */
    background-color: #e8e8e8;
}

.crm-chat-history-page .chat-avatar {
    width: 45px;
    height: 45px;
    border-radius: 50%; /* Hacer el avatar redondo */
    margin-right: 15px;
    object-fit: cover; /* Asegura que la imagen cubra el espacio sin deformarse */
}

.crm-chat-history-page .chat-item-details {
    flex-grow: 1; /* Ocupa el espacio restante */
    overflow: hidden; /* Evita que el contenido se desborde */
}

.crm-chat-history-page .chat-item-header {
    display: flex;
    justify-content: space-between; /* Nombre a la izq, hora a la der */
    align-items: center; /* Centrar verticalmente */
    margin-bottom: 4px;
}

/* Estilo para el nombre de la instancia en la lista de chats */
.crm-chat-history-page .chat-item-header .chat-item-instance { /* Estilo cuando está en el header */
    font-weight: 600; /* Más grueso */
    color: #0073aa; /* Azul WordPress */
    font-size: 0.9em;
    margin-right: 8px; /* Espacio antes del nombre */
    flex-shrink: 0; /* Evita que se encoja si el nombre es largo */
}

.crm-chat-history-page .chat-item-name {
    font-weight: 600;
    color: #111b21; /* Color oscuro para el nombre */
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    flex-grow: 1; /* Ocupa espacio disponible */
}

.crm-chat-history-page .chat-item-time {
    font-size: 0.8em;
    color: #667781; /* Color grisáceo para la hora */
    margin-left: 10px; /* Espacio entre nombre y hora */
    white-space: nowrap; /* Evita que la hora se parta */
    flex-shrink: 0; /* Evita que se encoja */
}

.crm-chat-history-page .chat-item-snippet {
    font-size: 0.9em;
    color: #54656f; /* Color gris más oscuro para el snippet */
    white-space: nowrap; /* Evita que el snippet se parta */
    overflow: hidden;
    text-overflow: ellipsis; /* Añade "..." si el texto es muy largo */
}

/* Estilos para mensajes de error o carga en la lista */
.crm-chat-history-page .chat-list-items p {
    padding: 15px;
    text-align: center;
    color: #667781;
}
.crm-chat-history-page .chat-list-items .error-message {
    color: #d33; /* Color rojo para errores */
}

.crm-chat-history-page .chat-list-items .spinner {
    margin-right: 5px;
}

/* ==========================================================================
   ESTILOS para Vista de Chat (Mensajes e Input)
   ========================================================================== */

   .crm-chat-history-page .chat-view-column { /* Contenedor de mensajes e input */
    flex-grow: 1; /* Ocupa el espacio restante */
    display: flex;
    flex-direction: column; /* Apila mensajes arriba, input abajo */
    background-color: #e5ddd5; /* Fondo tipo WhatsApp */
    min-height: 0; /* AÑADIDO: Ayuda al contenedor flex padre a manejar el overflow del hijo */
    /* Podríamos añadir una imagen de fondo aquí con background-image */
    /* overflow: hidden; */ /* <-- ¡Quita o comenta esta línea! */
}

.crm-chat-history-page .chat-messages-area { /* Área donde van las burbujas */
    flex-grow: 1; /* Ocupa todo el espacio vertical disponible */
    overflow-y: auto;
    
    min-height: 0; /* <-- DESCOMENTAR: Ayuda a Flexbox con el overflow */
    padding: 20px;
    
    /* === INICIO: Modificaciones a regla existente === */
    /* display: flex; Usar flexbox para centrar placeholder */
    /* flex-direction: column; Apilar mensajes verticalmente */
    /* === FIN: Modificaciones a regla existente === */
    background-color: #e5ddd5; /* Fondo similar a WA */
    /* background-image: url('../images/wa-background.png'); */ /* Opcional: patrón de fondo */
    /* background-repeat: repeat; */
}

/* === INICIO: Reglas Nuevas === */
/* Estilos cuando el placeholder está activo */
.crm-chat-history-page .chat-messages-area.chat-placeholder-active {
    display: flex; /* Usar flexbox SOLO para centrar placeholder */
    flex-direction: column; /* Necesario con flex */
    justify-content: center; /* Centrar verticalmente el placeholder */
    align-items: center; /* Centrar horizontalmente el placeholder */
    overflow: hidden; /* Ocultar scroll cuando está el placeholder (DEBE ESTAR ACTIVO) */
}

/* Contenedor del Placeholder */
.crm-chat-history-page .chat-placeholder-container {
    text-align: center;
    /* max-width: 450px; */
    color: #4a4a4a; /* Color de texto gris oscuro */
    display: none; /* Oculto por defecto */
}
.crm-chat-history-page .chat-messages-area.chat-placeholder-active .chat-placeholder-container {
    display: block; /* Mostrar solo cuando el área tiene la clase activa */
}

.crm-chat-history-page .chat-placeholder-image {
    max-width: 250px;
    margin-bottom: 20px;
    opacity: 0.8;
}

.crm-chat-history-page .chat-placeholder-title {
    font-size: 1.8em;
    margin-bottom: 10px;
    font-weight: 300; /* Fuente más ligera */
    color: #525252;
}

.crm-chat-history-page .chat-placeholder-text {
    font-size: 0.9em;
    line-height: 1.5;
    color: #666;
}
/* === FIN: Reglas Nuevas === */


.crm-chat-history-page .no-chat-selected { /* Estilo para el mensaje inicial */
    color: #50575e;
    font-size: 1.1em;
    text-align: center;
    background-color: #fff;
    padding: 20px;
    border-radius: 5px;
    box-shadow: 0 1px 1px rgba(0,0,0,0.05);
    margin: auto; /* Centrar el bloque */
}


/* --- Estilos Burbujas de Mensajes --- */

.crm-chat-history-page .chat-message {
    display: flex; /* Usa flex para alinear burbuja */
    margin-bottom: 10px;
    width: 100%;
}

.crm-chat-history-page .chat-message.outgoing {
    justify-content: flex-end; /* Alinea burbuja a la derecha */
}

.crm-chat-history-page .chat-message.incoming {
    justify-content: flex-start; /* Alinea burbuja a la izquierda */
}

.crm-chat-history-page .message-bubble {
    max-width: 70%; /* Ancho máximo de la burbuja */
    padding: 8px 12px;
    border-radius: 8px;
    position: relative; /* Para posicionar la hora */
    box-shadow: 0 1px 1px rgba(0,0,0,0.1);
    word-wrap: break-word; /* Rompe palabras largas */
}

.crm-chat-history-page .chat-message.outgoing .message-bubble {
    background-color: #dcf8c6; /* Verde claro WhatsApp */
    border-top-right-radius: 0; /* Esquina tipo WhatsApp */
}

.crm-chat-history-page .chat-message.incoming .message-bubble {
    background-color: #fff; /* Blanco */
    border-top-left-radius: 0; /* Esquina tipo WhatsApp */
}

.crm-chat-history-page .message-text {
    margin-bottom: 5px; /* Espacio antes de la hora */
    line-height: 1.4;
    white-space: pre-wrap; /* Respeta saltos de línea y espacios, pero permite wrap */
    word-wrap: break-word; /* Asegura que palabras largas se corten si es necesario */
}

.crm-chat-history-page .message-time {
    font-size: 0.75em;
    color: #aaa; /* Color gris claro para la hora */
    text-align: right;
    margin-top: 5px;
    clear: both; /* Asegura que esté debajo del contenido */
}

.crm-chat-history-page .chat-message.outgoing .message-time {
    color: #667781; /* Un poco más oscuro en mensajes salientes */
}

/* Estilos para Media */
.crm-chat-history-page .message-media img,
.crm-chat-history-page .message-media video {
    max-width: 100%; /* Ajusta al ancho de la burbuja */
    height: auto;
    display: block;
    border-radius: 5px; /* Bordes redondeados para media */
    margin-bottom: 5px; /* Espacio si hay caption */
}

.crm-chat-history-page .message-caption {
    margin-top: 5px;
    font-size: 0.9em;
    line-height: 1.3;
}

.crm-chat-history-page .message-document a {
    display: flex;
    align-items: center;
    text-decoration: none;
    color: inherit; /* Hereda color de texto */
}
.crm-chat-history-page .message-document .dashicons {
    margin-right: 8px;
    font-size: 1.5em;
}

/* Estilos para mensajes de carga/error en la columna de mensajes */
.crm-chat-history-page .chat-messages-area > p { /* Estilo para los párrafos directos */
    width: 100%;
    text-align: center;
    margin-top: 50px; /* Espacio superior */
    color: #667781;
}
.crm-chat-history-page .chat-messages-area > p.error-message {
    color: #d33;
}
.crm-chat-history-page .chat-messages-area > p .spinner {
    margin-right: 5px;
}

/* Estilos para el área de input de mensaje */
.crm-chat-history-page .chat-input-area {
    display: flex;
    align-items: center; /* Centra verticalmente los elementos */
    padding: 10px 15px;
    background-color: #f0f0f1; /* Fondo gris claro */
    border-top: 1px solid #dcdcdc;
    flex-shrink: 0;
}

.crm-chat-history-page .chat-input-area .btn-attach {
    margin-right: 10px;
    padding: 5px; /* Ajustar padding */
    line-height: 1; /* Ajustar altura línea */
}

.crm-chat-history-page .chat-input-area textarea {
    flex-grow: 1; /* Ocupa el espacio restante */
    border-radius: 18px; /* Bordes redondeados */
    padding: 8px 12px;
    border: 1px solid #dcdcdc;
    resize: none; /* Evitar que se pueda redimensionar */
    max-height: 100px; /* Limitar altura máxima si crece */
    margin-right: 10px;
    line-height: 1.4;
    /* Opcional: transiciones suaves si el textarea crece */
    /* transition: height 0.1s ease-out; */
}

.crm-chat-history-page .chat-input-area .btn-send {
    padding: 5px; /* Ajustar padding */
    line-height: 1; /* Ajustar altura línea */
}

/* --- Estilos para el botón de Emoji --- */
.crm-chat-history-page .btn-emoji {
    margin-right: 5px; /* Espacio a la derecha del botón emoji */
    padding: 5px; /* Ajustar padding si es necesario */
    line-height: 1; /* Ajustar altura línea */
}

/* --- Estilos Panel de Emojis --- */
.crm-chat-history-page .emoji-picker-container {
    position: absolute;
    bottom: 55px; /* Posicionar encima del área de input (ajustar según altura del input) */
    left: 10px; /* Ajustar posición horizontal */
    width: 300px; /* Ancho del panel */
    height: 250px; /* Alto del panel */
    background-color: #fff;
    border: 1px solid #ccc;
    border-radius: 8px;
    box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    padding: 10px;
    overflow-y: auto; /* Scroll si hay muchos emojis */
    z-index: 100; /* Asegurar que esté por encima */
    /* display: none; por defecto está oculto con style inline en el HTML */
}

.crm-chat-history-page .emoji-picker-container .emoji-option {
    display: inline-block; /* Para que respeten márgenes */
    font-size: 1.5em; /* Tamaño del emoji */
    margin: 5px;
    cursor: pointer; /* Indicar que es clicable */
}

/* --- Estilos Vista Previa Adjunto --- */
.crm-chat-history-page .chat-attachment-preview {
    position: relative; /* Para posicionar el botón de quitar */
    background-color: #f9f9f9;
    border: 1px solid #e0e0e0;
    border-radius: 5px;
    padding: 8px;
    margin-bottom: 8px; /* Espacio antes del textarea */
    display: flex; /* Alinear contenido */
    align-items: center;
    max-width: 95%; /* Evitar que sea demasiado ancho */
    /* display: none; por defecto está oculto con style inline en el HTML */
}

.crm-chat-history-page .chat-attachment-preview img { /* Estilo para miniatura de imagen */
    max-width: 50px;
    max-height: 50px;
    margin-right: 10px;
    border-radius: 3px;
}

.crm-chat-history-page .chat-attachment-preview .attachment-info { /* Para nombre de archivo */
    flex-grow: 1;
    font-size: 0.9em;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
}

.crm-chat-history-page .chat-attachment-preview .remove-attachment { /* Botón para quitar */
    background: none;
    border: none;
    color: #a00;
    cursor: pointer;
    font-size: 1.2em;
    padding: 0 5px;
    margin-left: 10px;
}

/* ==========================================================================
   ESTILOS para Columna Detalles del Contacto
   ========================================================================== */

.crm-chat-history-page .contact-details-column {
    flex: 0 0 300px; /* No crece, no encoge, base de 300px */
    border-left: 1px solid #ccd0d4; /* Separador izquierdo */
    background-color: #fff; /* Fondo blanco */
    display: flex; /* Usa flex para header y content */
    flex-direction: column; /* Apila header y content */
    overflow: hidden; /* Evita desbordamientos internos */
    /* --- Animación --- */
    /* display: none; se controla con JS/inline style */
}


/* Estado visible para la animación */
/* .is-visible ya no se usa */

.crm-chat-history-page .contact-details-header {
    padding: 10px 15px;
    padding-right: 40px; /* Espacio para el botón cerrar */
    border-bottom: 1px solid #ccd0d4;
    background-color: #f0f0f1; /* Fondo ligeramente gris */
    flex-shrink: 0; /* Evita que el header se encoja */
    position: relative; /* Para posicionar el botón cerrar */
    display: flex; /* Para alinear título y botón si es necesario */
    align-items: center; /* Centrar verticalmente */
    justify-content: space-between; /* Poner título a la izq, botón a la der */
}

.crm-chat-history-page .contact-details-header h3 {
    margin: 0;
    font-size: 1.1em;
    font-weight: 600; /* Un poco más de peso */
}

/* Estilo para el botón de cerrar */
.crm-chat-history-page .contact-details-header #close-contact-details {
    position: absolute; /* Posición absoluta respecto al header */
    top: 50%;
    right: 10px;
    transform: translateY(-50%); /* Centrar verticalmente */
    padding: 5px;
    cursor: pointer;
    background: none;
    border: none;
    color: #50575e; /* Color gris oscuro de WP */
}
.crm-chat-history-page .contact-details-header #close-contact-details:hover {
    color: #d63638; /* Rojo al pasar el mouse */
}

.crm-chat-history-page .contact-details-content {
    flex-grow: 1; /* Ocupa el espacio restante */
    overflow-y: auto; /* Scroll si el contenido es largo */
    padding: 15px;
    line-height: 1.6; /* Mejorar legibilidad */
}

/* Placeholder para futuros campos de formulario */
.crm-chat-history-page .contact-details-content .form-field {
    margin-bottom: 15px;
}
.crm-chat-history-page .contact-details-content .form-field label {
    display: block;
    font-weight: 600;
    margin-bottom: 5px;
}
.crm-chat-history-page .contact-details-content .form-field input[type="text"],
.crm-chat-history-page .contact-details-content .form-field input[type="email"],
.crm-chat-history-page .contact-details-content .form-field textarea {
    width: 100%;
    padding: 8px;
    border: 1px solid #ccd0d4;
    box-sizing: border-box; /* Incluir padding y borde en el ancho */
}